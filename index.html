<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nova Dating</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body {
      background-color: #111827;
      color: white;
      font-family: 'Helvetica', sans-serif;
      margin: 0;
      padding: 0;
    }
    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #1f2937;
      padding: 2rem;
      border-radius: 1rem;
      width: 90%;
      max-width: 400px;
      z-index: 50;
    }
    .modal-bg {
      position: fixed;
      inset: 0;
      background-color: rgba(0, 0, 0, 0.6);
      z-index: 40;
    }
    textarea {
      resize: none;
    }
  </style>
</head>
<body>
<div class="p-4 max-w-7xl mx-auto">
  <!-- Fixed Header -->
  <div class="sticky top-0 z-30 bg-[#111827] pb-2">
    <div class="flex items-center space-x-3 cursor-pointer mb-4" onclick="openProfileModal()">
      <img id="userPhoto" src="default.jpg" alt="User" class="w-12 h-12 rounded-full object-cover">
      <div class="text-white font-bold text-lg" id="userName">Welcome!</div>
    </div>

    <!-- Balance & Credit -->
    <div class="bg-gray-800 p-4 rounded-xl space-y-2 w-full max-w-[66.66%]">
      <div class="flex justify-between text-sm">
        <span>Balance:</span>
        <span id="balance">$0.00</span>
      </div>
      <div class="flex justify-between text-sm">
        <span>Credit:</span>
        <span id="credit">0</span>
      </div>
      <div class="flex flex-wrap gap-2 mt-3">
        <button onclick="openDepositModal()" class="bg-green-600 px-4 py-2 rounded-full text-sm">Deposit</button>
        <button onclick="openWithdrawModal()" class="bg-red-600 px-4 py-2 rounded-full text-sm">Withdraw</button>
        <button onclick="openTransferModal()" class="bg-blue-600 px-4 py-2 rounded-full text-sm">Transfer</button>
      </div>
    </div>

    <!-- Section Title -->
    <h2 class="mt-6 mb-4 text-white font-semibold text-lg pl-1">People You May Know</h2>
  </div>

  <!-- Users Grid -->
  <div id="userList" class="grid gap-4 md:grid-cols-4 mt-2">
    <!-- Example User Card -->
  </div>
</div>

<!-- Modals -->
<div id="profileModal" class="hidden modal-bg">
  <div class="modal">
    <h2 class="text-lg font-bold mb-4">Edit Profile</h2>
    <form id="profileForm">
      <input type="text" id="inputName" placeholder="Your Name" class="w-full mb-2 p-2 rounded text-black" />
      <input type="number" id="inputAge" placeholder="Age" class="w-full mb-2 p-2 rounded text-black" />
      <input type="text" id="inputCountry" placeholder="Country" class="w-full mb-2 p-2 rounded text-black" />
      <input type="text" id="inputHeight" placeholder="Height" class="w-full mb-2 p-2 rounded text-black" />
      <input type="file" id="inputPhoto" accept="image/*" class="w-full mb-2 p-2 rounded" />
      <button type="submit" class="bg-blue-600 w-full py-2 mt-2 rounded">Save</button>
      <button type="button" class="mt-2 text-sm text-gray-300" onclick="closeAllModals()">Cancel</button>
    </form>
  </div>
</div>

<div id="depositModal" class="hidden modal-bg">
  <div class="modal">
    <h2 class="text-lg font-bold mb-4">Deposit Funds</h2>
    <p>Send to till number <strong>1234</strong></p>
    <input type="text" id="depositCode" placeholder="Enter confirmation code" class="w-full p-2 rounded text-black mt-2" />
    <input type="number" id="depositAmount" placeholder="Amount" class="w-full p-2 rounded text-black mt-2" />
    <button onclick="processDeposit()" class="bg-green-600 w-full py-2 mt-2 rounded">Confirm</button>
    <button class="mt-2 text-sm text-gray-300" onclick="closeAllModals()">Cancel</button>
  </div>
</div>

<div id="withdrawModal" class="hidden modal-bg">
  <div class="modal">
    <h2 class="text-lg font-bold mb-4">Withdraw Funds</h2>
    <input type="text" id="withdrawCode" placeholder="Enter security code" class="w-full p-2 rounded text-black mt-2" />
    <input type="number" id="withdrawAmount" placeholder="Amount" class="w-full p-2 rounded text-black mt-2" />
    <button onclick="processWithdraw()" class="bg-red-600 w-full py-2 mt-2 rounded">Confirm</button>
    <button class="mt-2 text-sm text-gray-300" onclick="closeAllModals()">Cancel</button>
  </div>
</div>

<div id="transferModal" class="hidden modal-bg">
  <div class="modal">
    <h2 class="text-lg font-bold mb-4">Transfer to Credit</h2>
    <p class="text-sm mb-2">Every $1 will convert to 3 credits</p>
    <input type="number" id="transferAmount" placeholder="Amount in $" class="w-full p-2 rounded text-black mt-2" />
    <button onclick="processTransfer()" class="bg-blue-600 w-full py-2 mt-3 rounded">Transfer</button>
    <button class="mt-2 text-sm text-gray-300" onclick="closeAllModals()">Cancel</button>
  </div>
</div>

<div id="messageModal" class="hidden modal-bg">
  <div class="modal">
    <h2 id="messageModalTitle" class="text-lg font-bold mb-2">Notice</h2>
    <p id="messageModalText" class="text-sm"></p>
    <button class="mt-4 bg-gray-700 px-4 py-2 rounded" onclick="closeAllModals()">OK</button>
  </div>
</div>

<script>
  // Populate Users
  const exampleUsers = [
    { name: "Lena, 23", country: "Kenya", img: "user1.jpg" },
    { name: "Samuel, 29", country: "Nigeria", img: "user2.jpg" },
    { name: "Maya, 27", country: "Ghana", img: "user3.jpg" },
    { name: "Kevin, 30", country: "Uganda", img: "user4.jpg" },
    { name: "Rose, 25", country: "Tanzania", img: "user5.jpg" },
    { name: "Lena, 23", country: "Kenya", img: "user1.jpg" },
    { name: "Samuel, 29", country: "Nigeria", img: "user2.jpg" },
    { name: "Maya, 27", country: "Ghana", img: "user3.jpg" },
    { name: "Kevin, 30", country: "Uganda", img: "user4.jpg" },
    { name: "Rose, 25", country: "Tanzania", img: "user5.jpg" },
    { name: "Lena, 23", country: "Kenya", img: "user1.jpg" },
    { name: "Samuel, 29", country: "Nigeria", img: "user2.jpg" },
    { name: "Maya, 27", country: "Ghana", img: "user3.jpg" },
    { name: "Kevin, 30", country: "Uganda", img: "user4.jpg" },
    { name: "Rose, 25", country: "Tanzania", img: "user5.jpg" }
  ];

  const userList = document.getElementById("userList");
  exampleUsers.forEach(user => {
    const div = document.createElement("div");
    div.className = "flex items-start bg-gray-800 p-3 rounded-xl space-x-3";
    div.innerHTML = `
      <img src="${user.img}" class="w-12 h-12 rounded-full object-cover">
      <div class="flex-1">
        <div class="flex items-center space-x-2">
          <span class="font-semibold">${user.name}</span>
          <span class="text-green-400">●</span>
        </div>
        <div class="text-sm text-gray-400">${user.country}</div>
        <div class="mt-2 flex items-center space-x-2">
          <textarea rows="1" placeholder="Type message..." oninput="growTextArea(this)" class="w-full p-2 text-sm rounded text-black bg-white"></textarea>
          <button onclick="sendMessage(this)" class="text-blue-500 text-xl">➤</button>
        </div>
      </div>`;
    userList.appendChild(div);
  });

  function growTextArea(el) {
    el.style.height = "auto";
    el.style.height = (el.scrollHeight) + "px";
  }

  function sendMessage(btn) {
    const credit = parseFloat(localStorage.getItem("credit")) || 0;
    if (credit < 1) return showMessage("Notice", "Insufficient credit. Deposit to message.");
    const msg = btn.previousElementSibling.value.trim();
    if (!msg) return;
    btn.previousElementSibling.value = "";
    localStorage.setItem("credit", (credit - 1).toFixed(2));
    updateDisplayedValues();
    showMessage("Success", "Message sent!");
  }

  function openProfileModal() {
    document.getElementById("profileModal").classList.remove("hidden");
  }

  function openDepositModal() {
    closeAllModals();
    document.getElementById("depositModal").classList.remove("hidden");
  }

  function openWithdrawModal() {
    closeAllModals();
    document.getElementById("withdrawModal").classList.remove("hidden");
  }

  function openTransferModal() {
    closeAllModals();
    document.getElementById("transferModal").classList.remove("hidden");
  }

  function closeAllModals() {
    document.querySelectorAll(".modal-bg").forEach(modal => modal.classList.add("hidden"));
  }

  function processDeposit() {
    const code = document.getElementById("depositCode").value;
    const amount = parseFloat(document.getElementById("depositAmount").value);
    if (code === "1234" && amount > 0) {
      let balance = parseFloat(localStorage.getItem("balance")) || 0;
      let credit = parseFloat(localStorage.getItem("credit")) || 0;
      balance += amount;
      credit += Math.floor(amount / 5);
      localStorage.setItem("balance", balance.toFixed(2));
      localStorage.setItem("credit", credit.toFixed(2));
      updateDisplayedValues();
      closeAllModals();
      showMessage("Success", "Deposit successful!");
    } else {
      showMessage("Error", "Invalid code or amount.");
    }
  }

  function processWithdraw() {
    const code = document.getElementById("withdrawCode").value;
    const amount = parseFloat(document.getElementById("withdrawAmount").value);
    let balance = parseFloat(localStorage.getItem("balance")) || 0;
    if (code === "1234" && amount > 0 && amount <= balance) {
      balance -= amount;
      localStorage.setItem("balance", balance.toFixed(2));
      updateDisplayedValues();
      closeAllModals();
      showMessage("Success", "Withdraw successful!");
    } else {
      showMessage("Error", "Invalid withdrawal.");
    }
  }

  function processTransfer() {
    const amount = parseFloat(document.getElementById("transferAmount").value);
    let balance = parseFloat(localStorage.getItem("balance")) || 0;
    let credit = parseInt(localStorage.getItem("credit")) || 0;

    if (isNaN(amount) || amount <= 0) {
      showMessage("Invalid Amount", "Please enter a valid amount.");
      return;
    }

    if (amount > balance) {
      showMessage("Insufficient Funds", "You don't have enough balance to transfer this amount.");
      return;
    }

    balance -= amount;
    credit += Math.floor(amount * 3); // $1 = 3 credits

    localStorage.setItem("balance", balance.toFixed(2));
    localStorage.setItem("credit", credit);

    updateDisplayedValues(); // Fixed: correct function name
    closeAllModals();
    showMessage("Success", "Funds transferred to credit!");
  }

  function updateDisplayedValues() {
    const balance = parseFloat(localStorage.getItem("balance")) || 0;
    const credit = parseFloat(localStorage.getItem("credit")) || 0;

    document.getElementById("balance").innerText = "$" + balance.toFixed(2);
    document.getElementById("credit").innerText = credit.toFixed(2);
    document.getElementById("userName").innerText = localStorage.getItem("name") || "Welcome!";
    document.getElementById("userPhoto").src = localStorage.getItem("photo") || "default.jpg";
  }

  function showMessage(title, message) {
    document.getElementById("messageModalTitle").innerText = title || "Notice";
    document.getElementById("messageModalText").innerText = message || "";
    document.getElementById("messageModal").classList.remove("hidden");
  }

  document.getElementById("profileForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const name = document.getElementById("inputName").value;
    const photoInput = document.getElementById("inputPhoto");
    if (photoInput.files[0]) {
      const reader = new FileReader();
      reader.onload = function(e) {
        localStorage.setItem("photo", e.target.result);
        updateDisplayedValues();
      };
      reader.readAsDataURL(photoInput.files[0]);
    }
    localStorage.setItem("name", name);
    closeAllModals();
    updateDisplayedValues();
  });

  window.addEventListener("load", updateDisplayedValues);
</script>

</body>
</html>
